<!--
 Copyright 2019 Novartis Institutes for BioMedical Research Inc. Licensed
 under the Apache License, Version 2.0 (the "License"); you may not use
 this file except in compliance with the License. You may obtain a copy
 of the License at http://www.apache.org/licenses/LICENSE-2.0. Unless
 required by applicable law or agreed to in writing, software distributed
 under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES
 OR CONDITIONS OF ANY KIND, either express or implied. See the License for
 the specific language governing permissions and limitations under the License.
-->

<html>
<head>
     <title>Portable-CELLxGENE | Datasets</title>
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
     <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.ico') }}">
	{% for script in extra_scripts %}
	<script src="{{ script }}"></script>
     {% endfor %}
     <script src="{{ url_for('static', filename='js/annotation.js') }}"></script>
     <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap_min.css') }}">
     <link rel="stylesheet" href="{{ url_for('static', filename='css/fl_table.css') }}">
     <link rel="stylesheet" href="{{ url_for('static', filename='css/beautified.css') }}">

</head>
<body>
    <!-- <div style="background-color:#DBF1FF; border:5px solid #BBFFE5; padding-left:10px; padding-right:10px; padding-top: 10px; margin-top:-20px;"> -->
    <div class="subpage" style="padding-left:20px; padding-right:20px; padding-top:25px; margin-top:-25px; background-color:#FFE3E2;">
        <h4 style="text-align:left;float:left"><b>Portable-CELLxGENE</b></h4>
    <h6 style="text-align:right;float:right">help: <a style="color: inherit" href="https://github.com/george-hall-ucl/portable-cellxgene" target="_blank" rel="noopener noreferrer">github.com/george-hall-ucl/portable-cellxgene</a></h6>
    <hr style="clear:both; border-width:0px;"/>
    </div>
    <br>

     {{ rendered_html|safe }}

     <div class="subpage">
     <p>
     <center><h5><b><u>Instructions</u></b></h5></center>
     <u>Loading datasets</u><br>
     Datasets can be loaded in three ways:
     <ul>
         <li>üôà: Without annotations (and without the ability to create them).</li>
         <li>‚úçÔ∏è: Without annotations (with the ability to create them)</li>
         <li>With existing annotations</li>
     </ul>

     <u>Saving annotations</u><br>
     Clicking "Create annotations" will trigger a pop-up text box allowing you
     to enter a name for the annotation files. If needed, a folder with the
     name of the dataset plus "_annotations" will be created in the directory
     containing the dataset's .h5ad file. Cell-level annotations and gene-level
     gene sets will be saved in this folder as "[ENTERED_NAME].csv" and
     "[ENTERED_NAME]_gene_sets.csv", respectively. These files are saved
     automatically by CELLxGENE.

     <br><br><u>Transporting annotations</u><br>
     Since the annotation and gene sets files are CSVs, they are simple
     to transfer between users and datasets. Simply create a new folder in the
     same directory as your data (if needed), then copy the desired CSV files
     to this new directory. They will be detected by Portable-CELLxGENE (may
     have to be restarted).

     </p>
     </div>

     <p>
     {% if path %}
     <li><a href="{{ url_for('filecrawl') }}">top level</a></li>
     {% else %}
     {% endif %}
     <div class="subpage">
     <a href="{{ url_for('do_GET_status') }}" target="_blank" rel="noopener noreferrer">View running sessions</a>
     </div>
     </p>
     <script>
          $(() => {
               $("a.new").click(new_annotation_callback);
          })
     </script>

     <div class="subpage">
     <details>
     <summary>Licensing information</summary>

     <p>
     <center><h5>Licensing</h5></center>
     Portable-CELLxGENE is licensed under the GPL-3.0, available
     <a href = https://www.gnu.org/licenses/gpl-3.0.en.html>here</a>.
     It is copyright University College London 2023.
     <br><br>
     Portable-CELLxGENE contains executable versions of many other pieces
     of software. To ensure compliance with all relevant licensing terms,
     we list the copyrights and licenses of each component in the table
     below.
     <br>
     Note that if copyright is listed as "Unspecified" then this means that it
     was not made clear in the source code.

     <script src={{ url_for('static', filename='js/licenses.js') }}></script>
     <center>
     <div class="table-wrapper">
        <table class='fl-table'>
            <thead>
                <tr style="background: #CFCFCF">
                    <th width="20%">Software</th>
                    <th width="50%">Copyright</th>
                    <th width="15%">License</th>
                    <th width="15%">Source code</th>
                </tr>
            </thead>
            <tbody>
                <script>
                     for (let i = 0; i < licenses.length; i++) {
                         document.write('<tr>');
                         document.write('<td> <a href=' + licenses[i][1]);
                         document.write(' target="_blank" rel="noopener noreferrer">');
                         document.write(licenses[i][0] + '</td>');
                         document.write('<td style="text-align: left">' + licenses[i][2] + '</td>');
                         document.write('<td>')
                         for (let j = 0; j < licenses[i][3].length; j++) {
                             document.write('<a href=' + licenses_urls[licenses[i][3][j]]);
                             document.write(' target="_blank" rel="noopener noreferrer">');
                             document.write(licenses[i][3][j] + '</a>');

                             if ((licenses[i][3].length > 1) && (j < licenses[i][3].length - 1)) {
                                 document.write(' <br> ')
                             }
                         }
                         document.write('</td>')
                         document.write('<td><a href=' + licenses[i][4]);
                         document.write(' target="_blank" rel="noopener noreferrer" style="text-decoration:none">üîó</a></td>');
                         document.write('</tr>\n');
                      }
                </script>
            </tbody>
        </table>
     </div>
    </details>
     </div>

     <br>
     <footer style="margin-bottom:-50px;">
         <div class="subpage" style="height:50px">
         <div class="same-line">
             <div class="on-the-left">¬© University College London 2023-</div>
             <div class="on-the-right"><a style="color: inherit" href="https://github.com/george-hall-ucl/portable-cellxgene" target="_blank" rel="noopener noreferrer">github.com/george-hall-ucl/portable-cellxgene</a></div>
         </div>
         </div>
     </footer>
</body>
</html>
